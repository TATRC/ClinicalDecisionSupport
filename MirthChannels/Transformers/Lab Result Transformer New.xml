<com.webreach.mirth.model.Transformer>
  <steps>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>0</sequenceNumber>
      <name>InitializeArrays</name>
      <script>channelMap.put(&apos;labtests&apos;,new Array());</script>
      <type>JavaScript</type>
      <data class="map">
        <entry>
          <string>Script</string>
          <string>channelMap.put(&apos;labtests&apos;,new Array());</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>1</sequenceNumber>
      <name>labchsendingapp</name>
      <script>var mapping;try { mapping = msg[&apos;MSH&apos;][&apos;MSH.3&apos;][&apos;MSH.3.1&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;labchsendingapp&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
      <type>Mapper</type>
      <data class="map">
        <entry>
          <string>Variable</string>
          <string>labchsendingapp</string>
        </entry>
        <entry>
          <string>DefaultValue</string>
          <string></string>
        </entry>
        <entry>
          <string>RegularExpressions</string>
          <list/>
        </entry>
        <entry>
          <string>Mapping</string>
          <string>msg[&apos;MSH&apos;][&apos;MSH.3&apos;][&apos;MSH.3.1&apos;].toString()</string>
        </entry>
        <entry>
          <string>isGlobal</string>
          <string>channel</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>2</sequenceNumber>
      <name>labchsendingfacilty</name>
      <script>var mapping;try { mapping = msg[&apos;MSH&apos;][&apos;MSH.4&apos;][&apos;MSH.4.1&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;labchsendingfacilty&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
      <type>Mapper</type>
      <data class="map">
        <entry>
          <string>Variable</string>
          <string>labchsendingfacilty</string>
        </entry>
        <entry>
          <string>DefaultValue</string>
          <string></string>
        </entry>
        <entry>
          <string>RegularExpressions</string>
          <list/>
        </entry>
        <entry>
          <string>Mapping</string>
          <string>msg[&apos;MSH&apos;][&apos;MSH.4&apos;][&apos;MSH.4.1&apos;].toString()</string>
        </entry>
        <entry>
          <string>isGlobal</string>
          <string>channel</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>3</sequenceNumber>
      <name>labchdatetime</name>
      <script>var mapping;try { mapping = msg[&apos;MSH&apos;][&apos;MSH.7&apos;][&apos;MSH.7.1&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;labchdatetime&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
      <type>Mapper</type>
      <data class="map">
        <entry>
          <string>Variable</string>
          <string>labchdatetime</string>
        </entry>
        <entry>
          <string>DefaultValue</string>
          <string></string>
        </entry>
        <entry>
          <string>RegularExpressions</string>
          <list/>
        </entry>
        <entry>
          <string>Mapping</string>
          <string>msg[&apos;MSH&apos;][&apos;MSH.7&apos;][&apos;MSH.7.1&apos;].toString()</string>
        </entry>
        <entry>
          <string>isGlobal</string>
          <string>channel</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>4</sequenceNumber>
      <name>patientien</name>
      <script>var mapping;try { mapping = msg[&apos;PID&apos;][&apos;PID.3&apos;][&apos;PID.3.1&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;patientien&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
      <type>Mapper</type>
      <data class="map">
        <entry>
          <string>Variable</string>
          <string>patientien</string>
        </entry>
        <entry>
          <string>DefaultValue</string>
          <string></string>
        </entry>
        <entry>
          <string>RegularExpressions</string>
          <list/>
        </entry>
        <entry>
          <string>Mapping</string>
          <string>msg[&apos;PID&apos;][&apos;PID.3&apos;][&apos;PID.3.1&apos;].toString()</string>
        </entry>
        <entry>
          <string>isGlobal</string>
          <string>channel</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>5</sequenceNumber>
      <name>patientlastname</name>
      <script>var mapping;try { mapping = msg[&apos;PID&apos;][&apos;PID.5&apos;][&apos;PID.5.1&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;patientlastname&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
      <type>Mapper</type>
      <data class="map">
        <entry>
          <string>Variable</string>
          <string>patientlastname</string>
        </entry>
        <entry>
          <string>DefaultValue</string>
          <string></string>
        </entry>
        <entry>
          <string>RegularExpressions</string>
          <list/>
        </entry>
        <entry>
          <string>Mapping</string>
          <string>msg[&apos;PID&apos;][&apos;PID.5&apos;][&apos;PID.5.1&apos;].toString()</string>
        </entry>
        <entry>
          <string>isGlobal</string>
          <string>channel</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>6</sequenceNumber>
      <name>patientfirstname</name>
      <script>var mapping;try { mapping = msg[&apos;PID&apos;][&apos;PID.5&apos;][&apos;PID.5.2&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;patientfirstname&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
      <type>Mapper</type>
      <data class="map">
        <entry>
          <string>Variable</string>
          <string>patientfirstname</string>
        </entry>
        <entry>
          <string>DefaultValue</string>
          <string></string>
        </entry>
        <entry>
          <string>RegularExpressions</string>
          <list/>
        </entry>
        <entry>
          <string>Mapping</string>
          <string>msg[&apos;PID&apos;][&apos;PID.5&apos;][&apos;PID.5.2&apos;].toString()</string>
        </entry>
        <entry>
          <string>isGlobal</string>
          <string>channel</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>7</sequenceNumber>
      <name>labchresultstatus</name>
      <script>var mapping;try { mapping = msg[&apos;OBR&apos;][&apos;OBR.25&apos;][&apos;OBR.25.1&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;labchresultstatus&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
      <type>Mapper</type>
      <data class="map">
        <entry>
          <string>Variable</string>
          <string>labchresultstatus</string>
        </entry>
        <entry>
          <string>DefaultValue</string>
          <string></string>
        </entry>
        <entry>
          <string>RegularExpressions</string>
          <list/>
        </entry>
        <entry>
          <string>Mapping</string>
          <string>msg[&apos;OBR&apos;][&apos;OBR.25&apos;][&apos;OBR.25.1&apos;].toString()</string>
        </entry>
        <entry>
          <string>isGlobal</string>
          <string>channel</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>8</sequenceNumber>
      <name>labchrequestdate</name>
      <script>var mapping;try { mapping = msg[&apos;OBR&apos;][&apos;OBR.6&apos;][&apos;OBR.6.1&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;labchrequestdate&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
      <type>Mapper</type>
      <data class="map">
        <entry>
          <string>Variable</string>
          <string>labchrequestdate</string>
        </entry>
        <entry>
          <string>DefaultValue</string>
          <string></string>
        </entry>
        <entry>
          <string>RegularExpressions</string>
          <list/>
        </entry>
        <entry>
          <string>Mapping</string>
          <string>msg[&apos;OBR&apos;][&apos;OBR.6&apos;][&apos;OBR.6.1&apos;].toString()</string>
        </entry>
        <entry>
          <string>isGlobal</string>
          <string>channel</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>9</sequenceNumber>
      <name>labchobservdate</name>
      <script>var mapping;try { mapping = msg[&apos;OBR&apos;][&apos;OBR.7&apos;][&apos;OBR.7.1&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;labchobservdate&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
      <type>Mapper</type>
      <data class="map">
        <entry>
          <string>Variable</string>
          <string>labchobservdate</string>
        </entry>
        <entry>
          <string>DefaultValue</string>
          <string></string>
        </entry>
        <entry>
          <string>RegularExpressions</string>
          <list/>
        </entry>
        <entry>
          <string>Mapping</string>
          <string>msg[&apos;OBR&apos;][&apos;OBR.7&apos;][&apos;OBR.7.1&apos;].toString()</string>
        </entry>
        <entry>
          <string>isGlobal</string>
          <string>channel</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>10</sequenceNumber>
      <name>eventid</name>
      <script>var mapping;try { mapping = msg[&apos;MSH&apos;][&apos;MSH.10&apos;][&apos;MSH.10.1&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;eventid&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
      <type>Mapper</type>
      <data class="map">
        <entry>
          <string>Variable</string>
          <string>eventid</string>
        </entry>
        <entry>
          <string>DefaultValue</string>
          <string></string>
        </entry>
        <entry>
          <string>RegularExpressions</string>
          <list/>
        </entry>
        <entry>
          <string>Mapping</string>
          <string>msg[&apos;MSH&apos;][&apos;MSH.10&apos;][&apos;MSH.10.1&apos;].toString()</string>
        </entry>
        <entry>
          <string>isGlobal</string>
          <string>channel</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>11</sequenceNumber>
      <name>priority</name>
      <script>var mapping;try { mapping = msg[&apos;OBR&apos;][&apos;OBR.5&apos;][&apos;OBR.5.1&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;priority&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
      <type>Mapper</type>
      <data class="map">
        <entry>
          <string>Variable</string>
          <string>priority</string>
        </entry>
        <entry>
          <string>DefaultValue</string>
          <string></string>
        </entry>
        <entry>
          <string>RegularExpressions</string>
          <list/>
        </entry>
        <entry>
          <string>Mapping</string>
          <string>msg[&apos;OBR&apos;][&apos;OBR.5&apos;][&apos;OBR.5.1&apos;].toString()</string>
        </entry>
        <entry>
          <string>isGlobal</string>
          <string>channel</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>12</sequenceNumber>
      <name>accessionValue</name>
      <script>var mapping;try { mapping = msg[&apos;OBR&apos;][&apos;OBR.20&apos;][&apos;OBR.20.1&apos;].toString(); }catch (e) { logger.error(e);  mapping = &apos;&apos;;}channelMap.put(&apos;accessionValue&apos;, validate( mapping , &apos;&apos;, new Array()));</script>
      <type>Mapper</type>
      <data class="map">
        <entry>
          <string>Variable</string>
          <string>accessionValue</string>
        </entry>
        <entry>
          <string>DefaultValue</string>
          <string></string>
        </entry>
        <entry>
          <string>RegularExpressions</string>
          <list/>
        </entry>
        <entry>
          <string>Mapping</string>
          <string>msg[&apos;OBR&apos;][&apos;OBR.20&apos;][&apos;OBR.20.1&apos;].toString()</string>
        </entry>
        <entry>
          <string>isGlobal</string>
          <string>channel</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
    <com.webreach.mirth.model.Step>
      <sequenceNumber>13</sequenceNumber>
      <name>OBXProcess</name>
      <script>var i=0;
for each (seg in msg..OBX)
{
	   var labtests = channelMap.get(&apos;labtests&apos;);
       var test=new Object();
	   labtests[i] = test;
   
       test.id = seg[&apos;OBX.3&apos;][&apos;OBX.3.1&apos;].toString();
	   //TODO: Parse Range
       test.refrangelow = seg[&apos;OBX.7&apos;][&apos;OBX.7.1&apos;].toString();
       test.refrangehigh = seg[&apos;OBX.7&apos;][&apos;OBX.7.1&apos;].toString();
       test.refrange = seg[&apos;OBX.7&apos;][&apos;OBX.7.1&apos;].toString();
	   test.normalflag = seg[&apos;OBX.10&apos;][&apos;OBX.10.1&apos;].toString();
	   test.unitofmeasure = seg[&apos;OBX.6&apos;][&apos;OBX.6.1&apos;].toString();
       test.result = seg[&apos;OBX.5&apos;][&apos;OBX.5.1&apos;].toString();
   	   test.type = seg[&apos;OBX.3&apos;][&apos;OBX.3.5&apos;].toString();
	   test.subid = seg[&apos;OBX.3&apos;][&apos;OBX.3.3&apos;].toString();
       test.id = seg[&apos;OBX.3&apos;][&apos;OBX.3.1&apos;].toString();
       test.name = seg[&apos;OBX.3&apos;][&apos;OBX.3.2&apos;].toString();

	   //labchtestid[i] = obx_val
       //if(key.search(/HEIGHT/) != -1)channelMap.put(?HEIGHT?, obx_val);
       //if(key.search(/WEIGHT/) != -1)channelMap.put(?WEIGHT?, obx_val);
       i++;
}
channelMap.put(&apos;obx_seg_count&apos;, i);</script>
      <type>JavaScript</type>
      <data class="map">
        <entry>
          <string>Script</string>
          <string>var i=0;
for each (seg in msg..OBX)
{
	   var labtests = channelMap.get(&apos;labtests&apos;);
       var test=new Object();
	   labtests[i] = test;
   
       test.id = seg[&apos;OBX.3&apos;][&apos;OBX.3.1&apos;].toString();
	   //TODO: Parse Range
       test.refrangelow = seg[&apos;OBX.7&apos;][&apos;OBX.7.1&apos;].toString();
       test.refrangehigh = seg[&apos;OBX.7&apos;][&apos;OBX.7.1&apos;].toString();
       test.refrange = seg[&apos;OBX.7&apos;][&apos;OBX.7.1&apos;].toString();
	   test.normalflag = seg[&apos;OBX.10&apos;][&apos;OBX.10.1&apos;].toString();
	   test.unitofmeasure = seg[&apos;OBX.6&apos;][&apos;OBX.6.1&apos;].toString();
       test.result = seg[&apos;OBX.5&apos;][&apos;OBX.5.1&apos;].toString();
   	   test.type = seg[&apos;OBX.3&apos;][&apos;OBX.3.5&apos;].toString();
	   test.subid = seg[&apos;OBX.3&apos;][&apos;OBX.3.3&apos;].toString();
       test.id = seg[&apos;OBX.3&apos;][&apos;OBX.3.1&apos;].toString();
       test.name = seg[&apos;OBX.3&apos;][&apos;OBX.3.2&apos;].toString();

	   //labchtestid[i] = obx_val
       //if(key.search(/HEIGHT/) != -1)channelMap.put(?HEIGHT?, obx_val);
       //if(key.search(/WEIGHT/) != -1)channelMap.put(?WEIGHT?, obx_val);
       i++;
}
channelMap.put(&apos;obx_seg_count&apos;, i);</string>
        </entry>
      </data>
    </com.webreach.mirth.model.Step>
  </steps>
  <inboundTemplate>MSH|^~\&amp;|CHCS\LABCH|N00183|DATAGATE|3M|20070521115441.1-0400||ORU^R01|N00183-1143592|P|2.3|||||&#x0D;PID|1|^^^^^|411309^^^N00183^^N00183|20-390-71-8085^^^^FMPSSN~390718085^^^^SPONSSN~20^^^^FMP~A8085^^^^LNSPSSN~A8085^^^^LNSSN|AKE^ALBERT^^^^||19710113|M|^^^^^||1111 VIRGINIA DRIVE^^NEW YORK^NEW YORK^10111^^^||319-282-1234|319.600.0777|||No Preference|E411309|390-71-8085&#x0D;OBR|1|070521-00001^|070521 PCH 693|1835^GLUCOSE^^^^|ROUTINE||20070521115400.2-0400|||^^^^^^^||||20070521115412.1-0400|72&amp;SERUM&amp;99LRP&amp;&amp;&amp;18||||||||||F&#x0D;NTE|1||PROVIDER: 11546 CENTER, SUPPORT &#x0D;NTE|2||PRIORITY:ROUTINE&#x0D;NTE|3||SPECIMEN:SERUM&#x0D;NTE|4||DATE_ORDERED:20070521115300&#x0D;NTE|5||DATE_RESULTED:20070521115438.1-0400&#x0D;NTE|6||COLLECT_SAMPLE:BLOOD&#x0D;OBX|1|TX|1835-72^GLUCOSE^99LRT^^CH^||75|MG/DL^^^^^| (70-120)||||F&#x0D;NTE|1||DATE_RESULTED:20070521115438.1-0400&#x0D;</inboundTemplate>
  <outboundTemplate></outboundTemplate>
  <inboundProtocol>HL7V2</inboundProtocol>
  <outboundProtocol>HL7V2</outboundProtocol>
  <inboundProperties>
    <property name="useStrictParser">false</property>
    <property name="stripNamespaces">true</property>
    <property name="convertLFtoCR">true</property>
    <property name="handleRepetitions">false</property>
    <property name="useStrictValidation">false</property>
  </inboundProperties>
  <outboundProperties>
    <property name="stripNamespaces">true</property>
    <property name="convertLFtoCR">true</property>
  </outboundProperties>
</com.webreach.mirth.model.Transformer>